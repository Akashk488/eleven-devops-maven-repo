pipeline {

    agent {label 'jenkins_slave'}

    tools {
        dockerTool 'docker_new'
    }

   stages {

    stage ('Checkout_scm'){
        steps{
              checkout scm
        }
        
    }
    
    stage ('dockerbuid'){
         steps {
            sh 'sudo docker build -t akashk488/project:v1 .'
         }

    }
    stage ('docker_push'){
      
      steps {
        withCredentials([string(credentialsId: 'dockerpas', variable: 'dockerpas')]) {
     
     sh 'sudo docker login -u akashk488 -p ${dockerpas}'
      
      sh 'sudo docker push akashk488/project:v1' 
}
     

     }


      }
    }
    
   } 
