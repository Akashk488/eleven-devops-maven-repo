pipeline {

    agent {label 'jenkins_slave'}

   stages {

    stage ('Checkout_scm'){
        steps{
              checkout scm
        }
        
    }
    
    stage ('dockerbuid'){
         steps {
            script {
             sh 'docker build -t akashk488/tomee:v1 .'
            }
            
         }

    }
    stage ('docker_push'){
      
      steps {
        withCredentials([string(credentialsId: 'dockerpas', variable: 'dockerpas')]) {
     
     sh 'docker login -u akashk488 -p ${dockerpas}'
      
      sh 'docker push akashk488/tomee:v1' 
}
     

     }


      }
    }
    
   } 
