pipeline {

    agent {label 'jenkins_slave'}

   stages {

    stage ('Checkout_scm'){
        steps{
              checkout scm
        }
        
    }
    
    stage ('dockerbuid'){
         steps {
             sh 'docker build -t akashk488/newjavaproject:v3 .'
            }
            
         }

    
    stage ('docker_push'){
      
      steps {
        withCredentials([string(credentialsId: 'dockerpas', variable: 'dockerpas')]) {
     
     sh 'docker login -u akashk488 -p ${dockerpas}'
      
      sh 'docker push akashk488/newjavaproject:v3' 
}
     

     }


      }
    stage ('conatnization'){

      steps {

        sh 'docker run --name jP3 -p 8097:8080 -d akashk488/newjavaproject:v2 '
      }
    }

    }
    
   } 
